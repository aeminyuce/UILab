// out: false
/* dropdown */ @import 'ui.less';

@dropdown-open-z-index:                 19;
@dropdown-menu-open-scale:              .95;

@dropdown-toggle-icon-size:             12px;
@dropdown-toggle-right-icon-margins:    4px;

@dropdown-menu-space:                   1px;
@dropdown-menu-min-width:               (@layout-min - 60px);
@dropdown-menu-max-width:               (@sm-breakpoint - @highlight-space - (@border-dual * 2));

@dropdown-list-font-size:               (@large - 1);
@dropdown-list-line-height:             20px;
@dropdown-list-min-height:              30px;
@dropdown-list-padding:                 10px;
@dropdown-list-icon-size:               40px;

@dropdown-list-selected-bg:             fade(@black, 7.5%);
@dropdown-list-selected-bg-dark:        fade(@white, 7.5%);
@dropdown-list-hover-bg:                fade(@black, 5%);
@dropdown-list-hover-bg-dark:           fade(@black, 5%);
@dropdown-list-border:                  fade(@black, 4.5%);
@dropdown-list-border-dark:             fade(@white, 6.5%);

@dropdown-list-col-min-width:           680px;
@dropdown-list-col-2-min-width:         (@xs-breakpoint - 60);

@dropdown-grids-min-width:               (@layout-min - @highlight-space);
@dropdown-grids-col:                2;

._global-vars () {
    --dropdown-list-selected-bg: @dropdown-list-selected-bg;
    --dropdown-list-hover-bg: @dropdown-list-hover-bg;
    --dropdown-list-border: @dropdown-list-border;
}
._global-vars-dark () {
    --dropdown-list-selected-bg: @dropdown-list-selected-bg-dark;
    --dropdown-list-hover-bg: @dropdown-list-hover-bg-dark;
    --dropdown-list-border: @dropdown-list-border-dark;
}

.ease-dropdown {
    li { transition-property: background-color; transition-duration: @ease-default; }
    .dropdown-menu { transition-property: opacity, transform; transition-duration: @ease-default; transition-timing-function: ease-in-out; }

    & > .btn {
        transition-property: color, background-color, border-width, border-color, opacity, transform, box-shadow; transition-duration: @ease-default;

        .icon { transition-property: color, transform, opacity; transition-duration: @ease-default; }
    }
}

.dropdown {
    vertical-align: middle; display: inline-block; position: relative;

    &.open {
        z-index: @dropdown-open-z-index;

        & > .btn-ghost:not([class*="ui-fill-"]) { ._bg-var(btn-ghost-hover-bg) !important; }
    }
    &.open-ease {
        & > .btn {
            .toggle-icon { transform: rotate(-180deg); }
            .icon { opacity: 1; }
        }
    }

    & > .btn {
        display: block;

        &:not(.btn-square) { width: 100%; }

        .toggle-icon {
            ._icon(@dropdown-toggle-icon-size) !important; margin-top: -2px;

            &.right { margin-top: @dropdown-toggle-right-icon-margins; margin-bottom: @dropdown-toggle-right-icon-margins; }
        }
    }

    .dropdown-menu {
        ._bg-var(highlighted); overflow-x: hidden; overflow-y: auto; position: absolute; z-index: 1; transform-origin: top left;

        .mobile & { -webkit-overflow-scrolling: touch; }
    }


    &:not(.nav) {
        .dropdown-menu { max-width: @dropdown-menu-max-width; }
    }
    &.nav-full-h {
        position: static;

        .dropdown-menu {
            right: 0; left: 0; transform-origin: top center; z-index: @dropdown-open-z-index;

            &:before,&:after { content: ""; display: table; }
            &:after { clear: both; }
            & > .row { margin-left: inherit; margin-right: inherit; }
        }
    }
    &.menu-c {
        .dropdown-menu { transform-origin: top center; }
    }
    &.menu-l {
        .dropdown-menu { transform-origin: top right; }
    }
    &:not(.open) {
        .dropdown-menu { display: none !important; }
    }
    &:not(.open-ease) {
        .dropdown-menu { opacity: 0; transform: scale(@dropdown-menu-open-scale); }
    }
    &:not(.menu-t) {
        .dropdown-menu { margin-top: @dropdown-menu-space; }
    }
    &.menu-t {
        .dropdown-menu { margin-bottom: @dropdown-menu-space; bottom: 100%; transform-origin: bottom left; }

        &.menu-c {
            .dropdown-menu { transform-origin: bottom center; }
        }
        &.menu-l {
            .dropdown-menu { transform-origin: bottom right; }
        }
    }

    ul.dropdown-menu {
        list-style: none;

        & > li {
            line-height: @dropdown-list-line-height; min-height: @dropdown-list-min-height;

            &,a,& > label { font-size: @dropdown-list-font-size; }

            &:not(.holder) {
                padding: @dropdown-list-padding;

                &:not(:last-child) { ._border-var(@dir: border-bottom; @var: dropdown-list-border); }

                &,a,& > label { white-space: nowrap; text-overflow: ellipsis; overflow: hidden; display: block; }
                & > a { padding: @dropdown-list-padding; margin: -@dropdown-list-padding; }
                & > label {
                    padding: @dropdown-list-padding; margin: -@dropdown-list-padding; overflow: hidden; position: relative; cursor: pointer;

                    input { position: absolute; left: -20000px; }
                }
                &.selected {
                    & > label { ._bg-var(dropdown-list-selected-bg); }
                }
            }
        }
        &:not(.has-grid) > li {
            &,* { text-align: left !important; }
        }
        &.has-grid {
            display: flex; flex-wrap: wrap;

            & > li {
                text-align: center; width: percentage(((100 / @dropdown-grids-col) / 100%)); flex-grow: 1;

                a { text-align: center; }
                .icon,img { margin: (@dropdown-list-padding / 2) auto @dropdown-list-padding auto; display: block; }
            }
        }
        &.has-icon {
            & > li {
                padding-right: @dropdown-list-icon-size; position: relative;

                a { padding-right: @dropdown-list-icon-size; margin-right: -@dropdown-list-icon-size; }
                .list-icon { position: absolute; top: 50%; right: @dropdown-list-padding; transform: translateY(-50%); }
            }
        }
    }
    ul.dropdown-menu.has-grid li,[class*="list-column-"] > li {
        ._border-var(@dir: border-right; @var: dropdown-list-border);

        &[class*="ui-fill-dark-"],[class*="ui-fill-dark-"] & { border-color: @dropdown-list-border-dark !important; }
    }

    .has-grid {
        & > li {
            &:nth-last-child(2):not(:nth-child(2n)) { border-bottom: 0 !important; }
            &:nth-child(@{dropdown-grids-col}n),&:last-child { border-right: none !important; }
        }
    }

    .list-column- {
        &2 > li:nth-child(2n),&3 > li:nth-child(3n),&4 > li:nth-child(4n),&5 > li:nth-child(5n),&6 > li:nth-child(6n) { border-right: none; }
    }

    .desktop & {
        ul.dropdown-menu {
            & > li {
                &:not(.holder):hover { ._bg-var(dropdown-list-hover-bg); background-clip: padding-box; }
            }
        }
    }
}

.mobile-menu {
    .dropdown {
        display: block;

        & > .btn {
            .toggle-icon { position: absolute; top: 50%; right: @dropdown-list-padding; transform+_: translateY(-50%); }
        }
        &.open-ease {
            & > .btn {
                .toggle-icon { position: absolute; top: 50%; right: @dropdown-list-padding; transform: translateY(-50%) rotate(-180deg); }
            }
        }

        .dropdown-menu { background: none; max-height: inherit !important; overflow: inherit; position: static; box-shadow: none; transform-origin: top center !important; }
        ul.dropdown-menu {
            & > li {
                &:not(:last-child) { border-bottom: 0; }
            }
            &.round {
                & > li {
                    &,a { border-radius: @round; }
                }
            }
        }

        &:not(:last-child) {
            .dropdown-menu { margin-bottom: (@highlight-space / 2) !important; }
        }
    }

    [class*="list-column-"] {
        & > li { border-right: 0; }
    }
}

@media (@md-start) {
    .dropdown {
        .dropdown-menu {
            min-width: @dropdown-menu-min-width;

            &.list-column-2 { min-width: @dropdown-list-col-2-min-width; }
            &[class*="list-column-"] { min-width: @dropdown-list-col-min-width; }
        }
        ul.dropdown-menu.has-grid { min-width: @dropdown-grids-min-width; }
    }
}
@media (@sm-finish) {
    .dropdown {
        .dropdown-menu { transform-origin: top center !important; }
    }
}